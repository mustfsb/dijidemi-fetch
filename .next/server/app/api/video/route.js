"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/video/route";
exports.ids = ["app/api/video/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "playwright":
/*!*****************************!*\
  !*** external "playwright" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("playwright");

/***/ }),

/***/ "@sparticuz/chromium":
/*!**************************************!*\
  !*** external "@sparticuz/chromium" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("@sparticuz/chromium");

/***/ }),

/***/ "playwright-core":
/*!**********************************!*\
  !*** external "playwright-core" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("playwright-core");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvideo%2Froute&page=%2Fapi%2Fvideo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvideo%2Froute.ts&appDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvideo%2Froute&page=%2Fapi%2Fvideo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvideo%2Froute.ts&appDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_mustafa_Documents_GitHub_dijidemi_fetch_app_api_video_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/video/route.ts */ \"(rsc)/./app/api/video/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/video/route\",\n        pathname: \"/api/video\",\n        filename: \"route\",\n        bundlePath: \"app/api/video/route\"\n    },\n    resolvedPagePath: \"/Users/mustafa/Documents/GitHub/dijidemi-fetch/app/api/video/route.ts\",\n    nextConfigOutput,\n    userland: _Users_mustafa_Documents_GitHub_dijidemi_fetch_app_api_video_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/video/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ2aWRlbyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGdmlkZW8lMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZ2aWRlbyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm11c3RhZmElMkZEb2N1bWVudHMlMkZHaXRIdWIlMkZkaWppZGVtaS1mZXRjaCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZtdXN0YWZhJTJGRG9jdW1lbnRzJTJGR2l0SHViJTJGZGlqaWRlbWktZmV0Y2gmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDcUI7QUFDbEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0LWFwcC8/MDNlZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvbXVzdGFmYS9Eb2N1bWVudHMvR2l0SHViL2RpamlkZW1pLWZldGNoL2FwcC9hcGkvdmlkZW8vcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3ZpZGVvL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdmlkZW9cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3ZpZGVvL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL211c3RhZmEvRG9jdW1lbnRzL0dpdEh1Yi9kaWppZGVtaS1mZXRjaC9hcHAvYXBpL3ZpZGVvL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3ZpZGVvL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvideo%2Froute&page=%2Fapi%2Fvideo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvideo%2Froute.ts&appDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/video/route.ts":
/*!********************************!*\
  !*** ./app/api/video/route.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_cookie_cookieManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/cookie/cookieManager */ \"(rsc)/./lib/cookie/cookieManager.ts\");\n\n\nasync function GET(request) {\n    const { searchParams } = new URL(request.url);\n    const testId = searchParams.get(\"testId\");\n    const soruId = searchParams.get(\"soruId\");\n    if (!testId || !soruId) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Missing testId or soruId\"\n        }, {\n            status: 400\n        });\n    }\n    // Headers from user request\n    const headers = await _lib_cookie_cookieManager__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getHeaders();\n    const url = `https://www.dijidemi.com/Ogrenci2020/Video?___layout`;\n    // Body from user request: tur=2&sinavId=0&sinavTuru=2&testId=1120092&soruId=1\n    const body = `tur=2&sinavId=0&sinavTuru=2&testId=${testId}&soruId=${soruId}`;\n    try {\n        const response = await fetch(url, {\n            method: \"POST\",\n            headers: {\n                ...headers,\n                \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\"\n            },\n            body: body\n        });\n        if (!response.ok) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: `Upstream error: ${response.status}`\n            }, {\n                status: response.status\n            });\n        }\n        const html = await response.text();\n        // Extract video URL - Robust Regex\n        // Matches <video src=\"...\">, <source src=\"...\">, or known patterns\n        let videoUrl = null;\n        // Pattern 1: <video ... src=\"...\">\n        const videoSrcMatch = html.match(/<video[^>]*src=\"([^\"]+)\"/i);\n        if (videoSrcMatch) videoUrl = videoSrcMatch[1];\n        // Pattern 2: <source src=\"...\"> inside video\n        if (!videoUrl) {\n            const sourceSrcMatch = html.match(/<source[^>]*src=\"([^\"]+)\"/i);\n            if (sourceSrcMatch) videoUrl = sourceSrcMatch[1];\n        }\n        // Pattern 3: JSON embedded or other\n        if (!videoUrl) {\n            // Check for direct .mp4 links in quotes\n            const mp4Match = html.match(/\"([^\"]+\\.mp4)\"/);\n            if (mp4Match) videoUrl = mp4Match[1];\n        }\n        if (videoUrl) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true,\n                videoUrl: videoUrl,\n                testId,\n                soruId\n            });\n        } else {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                message: \"Video not found\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Video Proxy Error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal Server Error\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3ZpZGVvL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF3RDtBQUNEO0FBR2hELGVBQWVFLElBQUlDLE9BQW9CO0lBQzFDLE1BQU0sRUFBRUMsWUFBWSxFQUFFLEdBQUcsSUFBSUMsSUFBSUYsUUFBUUcsR0FBRztJQUM1QyxNQUFNQyxTQUFTSCxhQUFhSSxHQUFHLENBQUM7SUFDaEMsTUFBTUMsU0FBU0wsYUFBYUksR0FBRyxDQUFDO0lBRWhDLElBQUksQ0FBQ0QsVUFBVSxDQUFDRSxRQUFRO1FBQ3BCLE9BQU9ULGtGQUFZQSxDQUFDVSxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUEyQixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNsRjtJQUVBLDRCQUE0QjtJQUM1QixNQUFNQyxVQUFVLE1BQU1aLGlFQUFhQSxDQUFDYSxVQUFVO0lBRTlDLE1BQU1SLE1BQU0sQ0FBQyxvREFBb0QsQ0FBQztJQUVsRSw4RUFBOEU7SUFDOUUsTUFBTVMsT0FBTyxDQUFDLG1DQUFtQyxFQUFFUixPQUFPLFFBQVEsRUFBRUUsT0FBTyxDQUFDO0lBRTVFLElBQUk7UUFDQSxNQUFNTyxXQUFXLE1BQU1DLE1BQU1YLEtBQUs7WUFDOUJZLFFBQVE7WUFDUkwsU0FBUztnQkFDTCxHQUFHQSxPQUFPO2dCQUNWLGdCQUFnQjtZQUNwQjtZQUNBRSxNQUFNQTtRQUNWO1FBRUEsSUFBSSxDQUFDQyxTQUFTRyxFQUFFLEVBQUU7WUFDZCxPQUFPbkIsa0ZBQVlBLENBQUNVLElBQUksQ0FBQztnQkFBRUMsT0FBTyxDQUFDLGdCQUFnQixFQUFFSyxTQUFTSixNQUFNLENBQUMsQ0FBQztZQUFDLEdBQUc7Z0JBQUVBLFFBQVFJLFNBQVNKLE1BQU07WUFBQztRQUN4RztRQUVBLE1BQU1RLE9BQU8sTUFBTUosU0FBU0ssSUFBSTtRQUVoQyxtQ0FBbUM7UUFDbkMsbUVBQW1FO1FBQ25FLElBQUlDLFdBQTBCO1FBRTlCLG1DQUFtQztRQUNuQyxNQUFNQyxnQkFBZ0JILEtBQUtJLEtBQUssQ0FBQztRQUNqQyxJQUFJRCxlQUFlRCxXQUFXQyxhQUFhLENBQUMsRUFBRTtRQUU5Qyw2Q0FBNkM7UUFDN0MsSUFBSSxDQUFDRCxVQUFVO1lBQ1gsTUFBTUcsaUJBQWlCTCxLQUFLSSxLQUFLLENBQUM7WUFDbEMsSUFBSUMsZ0JBQWdCSCxXQUFXRyxjQUFjLENBQUMsRUFBRTtRQUNwRDtRQUVBLG9DQUFvQztRQUNwQyxJQUFJLENBQUNILFVBQVU7WUFDWCx3Q0FBd0M7WUFDeEMsTUFBTUksV0FBV04sS0FBS0ksS0FBSyxDQUFDO1lBQzVCLElBQUlFLFVBQVVKLFdBQVdJLFFBQVEsQ0FBQyxFQUFFO1FBQ3hDO1FBRUEsSUFBSUosVUFBVTtZQUNWLE9BQU90QixrRkFBWUEsQ0FBQ1UsSUFBSSxDQUFDO2dCQUNyQmlCLFNBQVM7Z0JBQ1RMLFVBQVVBO2dCQUNWZjtnQkFDQUU7WUFDSjtRQUNKLE9BQU87WUFDSCxPQUFPVCxrRkFBWUEsQ0FBQ1UsSUFBSSxDQUFDO2dCQUNyQmlCLFNBQVM7Z0JBQ1RDLFNBQVM7WUFFYjtRQUNKO0lBRUosRUFBRSxPQUFPakIsT0FBTztRQUNaa0IsUUFBUWxCLEtBQUssQ0FBQyxzQkFBc0JBO1FBQ3BDLE9BQU9YLGtGQUFZQSxDQUFDVSxJQUFJLENBQUM7WUFBRUMsT0FBTztZQUF5Qm1CLFNBQVNuQixpQkFBaUJvQixRQUFRcEIsTUFBTWlCLE9BQU8sR0FBRztRQUFnQixHQUFHO1lBQUVoQixRQUFRO1FBQUk7SUFDbEo7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtYXBwLy4vYXBwL2FwaS92aWRlby9yb3V0ZS50cz9iNTJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgY29va2llTWFuYWdlciBmcm9tICdAL2xpYi9jb29raWUvY29va2llTWFuYWdlcic7XG5pbXBvcnQgdHlwZSB7IFZpZGVvUmVzcG9uc2UgfSBmcm9tICdAL3R5cGVzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCk6IFByb21pc2U8TmV4dFJlc3BvbnNlPFZpZGVvUmVzcG9uc2UgfCB7IGVycm9yOiBzdHJpbmc7IGRldGFpbHM/OiBzdHJpbmcgfT4+IHtcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XG4gICAgY29uc3QgdGVzdElkID0gc2VhcmNoUGFyYW1zLmdldCgndGVzdElkJyk7XG4gICAgY29uc3Qgc29ydUlkID0gc2VhcmNoUGFyYW1zLmdldCgnc29ydUlkJyk7XG5cbiAgICBpZiAoIXRlc3RJZCB8fCAhc29ydUlkKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWlzc2luZyB0ZXN0SWQgb3Igc29ydUlkJyB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cblxuICAgIC8vIEhlYWRlcnMgZnJvbSB1c2VyIHJlcXVlc3RcbiAgICBjb25zdCBoZWFkZXJzID0gYXdhaXQgY29va2llTWFuYWdlci5nZXRIZWFkZXJzKCk7XG5cbiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly93d3cuZGlqaWRlbWkuY29tL09ncmVuY2kyMDIwL1ZpZGVvP19fX2xheW91dGA7XG5cbiAgICAvLyBCb2R5IGZyb20gdXNlciByZXF1ZXN0OiB0dXI9MiZzaW5hdklkPTAmc2luYXZUdXJ1PTImdGVzdElkPTExMjAwOTImc29ydUlkPTFcbiAgICBjb25zdCBib2R5ID0gYHR1cj0yJnNpbmF2SWQ9MCZzaW5hdlR1cnU9MiZ0ZXN0SWQ9JHt0ZXN0SWR9JnNvcnVJZD0ke3NvcnVJZH1gO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIC4uLmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogYm9keVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogYFVwc3RyZWFtIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gIH0sIHsgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBodG1sID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuXG4gICAgICAgIC8vIEV4dHJhY3QgdmlkZW8gVVJMIC0gUm9idXN0IFJlZ2V4XG4gICAgICAgIC8vIE1hdGNoZXMgPHZpZGVvIHNyYz1cIi4uLlwiPiwgPHNvdXJjZSBzcmM9XCIuLi5cIj4sIG9yIGtub3duIHBhdHRlcm5zXG4gICAgICAgIGxldCB2aWRlb1VybDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgICAgICAgLy8gUGF0dGVybiAxOiA8dmlkZW8gLi4uIHNyYz1cIi4uLlwiPlxuICAgICAgICBjb25zdCB2aWRlb1NyY01hdGNoID0gaHRtbC5tYXRjaCgvPHZpZGVvW14+XSpzcmM9XCIoW15cIl0rKVwiL2kpO1xuICAgICAgICBpZiAodmlkZW9TcmNNYXRjaCkgdmlkZW9VcmwgPSB2aWRlb1NyY01hdGNoWzFdO1xuXG4gICAgICAgIC8vIFBhdHRlcm4gMjogPHNvdXJjZSBzcmM9XCIuLi5cIj4gaW5zaWRlIHZpZGVvXG4gICAgICAgIGlmICghdmlkZW9VcmwpIHtcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZVNyY01hdGNoID0gaHRtbC5tYXRjaCgvPHNvdXJjZVtePl0qc3JjPVwiKFteXCJdKylcIi9pKTtcbiAgICAgICAgICAgIGlmIChzb3VyY2VTcmNNYXRjaCkgdmlkZW9VcmwgPSBzb3VyY2VTcmNNYXRjaFsxXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFBhdHRlcm4gMzogSlNPTiBlbWJlZGRlZCBvciBvdGhlclxuICAgICAgICBpZiAoIXZpZGVvVXJsKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgZGlyZWN0IC5tcDQgbGlua3MgaW4gcXVvdGVzXG4gICAgICAgICAgICBjb25zdCBtcDRNYXRjaCA9IGh0bWwubWF0Y2goL1wiKFteXCJdK1xcLm1wNClcIi8pO1xuICAgICAgICAgICAgaWYgKG1wNE1hdGNoKSB2aWRlb1VybCA9IG1wNE1hdGNoWzFdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHZpZGVvVXJsKSB7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgdmlkZW9Vcmw6IHZpZGVvVXJsLFxuICAgICAgICAgICAgICAgIHRlc3RJZCxcbiAgICAgICAgICAgICAgICBzb3J1SWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnVmlkZW8gbm90IGZvdW5kJyxcbiAgICAgICAgICAgICAgICAvLyBodG1sU25pcHBldDogaHRtbC5zdWJzdHJpbmcoMCwgNTAwKSAvLyBERUJVRzogUmVtb3ZlIGluIHByb2QgaWYgc3BhbW15XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignVmlkZW8gUHJveHkgRXJyb3I6JywgZXJyb3IpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIFNlcnZlciBFcnJvcicsIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNvb2tpZU1hbmFnZXIiLCJHRVQiLCJyZXF1ZXN0Iiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwidGVzdElkIiwiZ2V0Iiwic29ydUlkIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiaGVhZGVycyIsImdldEhlYWRlcnMiLCJib2R5IiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsIm9rIiwiaHRtbCIsInRleHQiLCJ2aWRlb1VybCIsInZpZGVvU3JjTWF0Y2giLCJtYXRjaCIsInNvdXJjZVNyY01hdGNoIiwibXA0TWF0Y2giLCJzdWNjZXNzIiwibWVzc2FnZSIsImNvbnNvbGUiLCJkZXRhaWxzIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/video/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/cookie/cookieManager.ts":
/*!*************************************!*\
  !*** ./lib/cookie/cookieManager.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _playwrightService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./playwrightService */ \"(rsc)/./lib/cookie/playwrightService.ts\");\n/* harmony import */ var _lib_db_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db/supabase */ \"(rsc)/./lib/db/supabase.ts\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nclass CookieManager {\n    constructor(){\n        this.isRefreshing = false;\n        this.refreshPromise = null;\n        this.lastDbCheck = 0;\n        this.DB_CHECK_INTERVAL = 1000 * 60 * 5 // Check DB every 5 mins for updates from other instances\n        ;\n        // Initial empty state, will be populated async\n        this.cookies = {\n            \"cf_clearance\": \"\",\n            \"ASP.NET_SessionId\": \"\",\n            \"usrtkn\": \"\"\n        };\n        this.baseHeaders = {\n            \"Host\": \"www.dijidemi.com\",\n            \"Accept\": \"application/json, text/plain, */*\",\n            \"User-Agent\": \"DijidemiMobile/41 CFNetwork/3860.300.31 Darwin/25.2.0\",\n            \"Accept-Language\": \"en-US,en;q=0.9\",\n            \"Accept-Encoding\": \"gzip, deflate, br\",\n            \"Connection\": \"keep-alive\"\n        };\n    }\n    getCookieString() {\n        return Object.entries(this.cookies).filter(([_, value])=>value) // Filter out empty values\n        .map(([key, value])=>`${key}=${value}`).join(\"; \");\n    }\n    /**\n     * Loads cookies from Supabase.\n     * Returns true if cookies were found and loaded, false otherwise.\n     */ async loadFromSupabase() {\n        try {\n            const { data, error } = await _lib_db_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"auth_cookies\").select(\"*\").order(\"updated_at\", {\n                ascending: false\n            }).limit(1).single();\n            if (error) {\n                // It's okay if no rows exist yet or table is empty\n                if (error.code !== \"PGRST116\") {\n                    console.error(\"Error fetching cookies from Supabase:\", error);\n                }\n                return false;\n            }\n            if (data && data.cookie_json) {\n                const parsed = typeof data.cookie_json === \"string\" ? JSON.parse(data.cookie_json) : data.cookie_json;\n                this.cookies = {\n                    ...this.cookies,\n                    ...parsed\n                };\n                return true;\n            }\n        } catch (err) {\n            console.error(\"Unexpected error loading cookies:\", err);\n        }\n        return false;\n    }\n    async saveToSupabase(cookies) {\n        try {\n            console.log(\"Saving cookies to Supabase...\");\n            // Upsert into auth_cookies with a fixed ID to ensure singleton-like behavior\n            const { error } = await _lib_db_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"auth_cookies\").upsert({\n                id: 1,\n                cookie_json: cookies,\n                updated_at: new Date().toISOString()\n            });\n            if (error) {\n                console.error(\"Error saving cookies to Supabase:\", JSON.stringify(error, null, 2));\n                // Add hint about RLS/Keys\n                if (error.code === \"42501\") {\n                    console.error(\"Hint: Check if SUPABASE_SERVICE_ROLE_KEY is set in Netlify Environment Variables and if RLS policies allow the write.\");\n                }\n            } else {\n                console.log(\"Successfully saved to Supabase.\");\n            }\n            // Also save to local file (simulating \"local storage\" persistence on server)\n            try {\n                // In Lambda/Netlify, only /tmp is writable\n                const isLambda = !!process.env.AWS_LAMBDA_FUNCTION_VERSION || !!process.env.NETLIFY || !!process.env.AWS_LAMBDA_FUNCTION_NAME;\n                const dir = isLambda ? \"/tmp\" : path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"lib/cookie\");\n                // Ensure dir exists locally\n                if (!isLambda && !fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(dir)) {\n                    fs__WEBPACK_IMPORTED_MODULE_2___default().mkdirSync(dir, {\n                        recursive: true\n                    });\n                }\n                const filePath = path__WEBPACK_IMPORTED_MODULE_3___default().join(dir, \"cookies.json\");\n                fs__WEBPACK_IMPORTED_MODULE_2___default().writeFileSync(filePath, JSON.stringify(cookies, null, 2));\n                console.log(`Saved backup copy to ${filePath}`);\n            } catch (localError) {\n                // Ignore local write errors in production/serverless if read-only\n                console.warn(\"Could not save to local cookies.json:\", localError);\n            }\n        } catch (err) {\n            console.error(\"Unexpected error saving cookies:\", err);\n        }\n    }\n    async ensureValidCookies(force = false) {\n        // 1. Check if we have valid cookies in memory\n        const hasInMemoryCookies = this.cookies[\"cf_clearance\"] && this.cookies[\"ASP.NET_SessionId\"];\n        // 2. If not, or if it's been a while, try to load from DB first\n        const timeSinceLastDbCheck = Date.now() - this.lastDbCheck;\n        if (!hasInMemoryCookies || timeSinceLastDbCheck > this.DB_CHECK_INTERVAL) {\n            await this.loadFromSupabase();\n            this.lastDbCheck = Date.now();\n        }\n        const hasCookies = this.cookies[\"cf_clearance\"] && this.cookies[\"ASP.NET_SessionId\"];\n        if (hasCookies && !force) {\n            return;\n        }\n        // Avoid multiple simultaneous refreshes\n        if (this.isRefreshing) {\n            if (this.refreshPromise) await this.refreshPromise;\n            return;\n        }\n        this.isRefreshing = true;\n        this.refreshPromise = (async ()=>{\n            try {\n                console.log(\"Refreshing cookies via Playwright...\");\n                const newCookies = await _playwrightService__WEBPACK_IMPORTED_MODULE_0__.playwrightService.getFreshCookies();\n                // usrtkn often matches ASP.NET_SessionId with a prefix\n                if (newCookies[\"ASP.NET_SessionId\"] && !newCookies[\"usrtkn\"]) {\n                    newCookies[\"usrtkn\"] = `tkn=${newCookies[\"ASP.NET_SessionId\"]}`;\n                }\n                this.cookies = {\n                    ...this.cookies,\n                    ...newCookies\n                };\n                await this.saveToSupabase(this.cookies);\n                console.log(\"Cookies refreshed and saved to Supabase.\");\n            } catch (error) {\n                console.error(\"Failed to refresh cookies:\", error);\n            } finally{\n                this.isRefreshing = false;\n                this.refreshPromise = null;\n            }\n        })();\n        await this.refreshPromise;\n    }\n    async getHeaders() {\n        await this.ensureValidCookies(false);\n        return {\n            ...this.baseHeaders,\n            \"Cookie\": this.getCookieString()\n        };\n    }\n    // Called by Cron Job\n    async refreshCookies() {\n        await this.ensureValidCookies(true);\n    }\n}\nconst cookieManager = new CookieManager();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (cookieManager);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFrQixDQUFDO0lBQ2xDO0FBQ0o7QUFFQSxNQUFNVSxnQkFBZ0IsSUFBSWxFO0FBQzFCLGlFQUFla0UsYUFBYUEsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtYXBwLy4vbGliL2Nvb2tpZS9jb29raWVNYW5hZ2VyLnRzP2FjNjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29va2llUmVjb3JkLCBIZWFkZXJSZWNvcmQgfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IHBsYXl3cmlnaHRTZXJ2aWNlIH0gZnJvbSAnLi9wbGF5d3JpZ2h0U2VydmljZSc7XG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJ0AvbGliL2RiL3N1cGFiYXNlJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuY2xhc3MgQ29va2llTWFuYWdlciB7XG4gICAgcHJpdmF0ZSBjb29raWVzOiBDb29raWVSZWNvcmQ7XG4gICAgcHJpdmF0ZSBiYXNlSGVhZGVyczogSGVhZGVyUmVjb3JkO1xuICAgIHByaXZhdGUgaXNSZWZyZXNoaW5nOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSByZWZyZXNoUHJvbWlzZTogUHJvbWlzZTx2b2lkPiB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgbGFzdERiQ2hlY2s6IG51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSByZWFkb25seSBEQl9DSEVDS19JTlRFUlZBTCA9IDEwMDAgKiA2MCAqIDU7IC8vIENoZWNrIERCIGV2ZXJ5IDUgbWlucyBmb3IgdXBkYXRlcyBmcm9tIG90aGVyIGluc3RhbmNlc1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIEluaXRpYWwgZW1wdHkgc3RhdGUsIHdpbGwgYmUgcG9wdWxhdGVkIGFzeW5jXG4gICAgICAgIHRoaXMuY29va2llcyA9IHtcbiAgICAgICAgICAgICdjZl9jbGVhcmFuY2UnOiAnJyxcbiAgICAgICAgICAgICdBU1AuTkVUX1Nlc3Npb25JZCc6ICcnLFxuICAgICAgICAgICAgJ3VzcnRrbic6ICcnXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5iYXNlSGVhZGVycyA9IHtcbiAgICAgICAgICAgIFwiSG9zdFwiOiBcInd3dy5kaWppZGVtaS5jb21cIixcbiAgICAgICAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qXCIsXG4gICAgICAgICAgICBcIlVzZXItQWdlbnRcIjogXCJEaWppZGVtaU1vYmlsZS80MSBDRk5ldHdvcmsvMzg2MC4zMDAuMzEgRGFyd2luLzI1LjIuMFwiLFxuICAgICAgICAgICAgXCJBY2NlcHQtTGFuZ3VhZ2VcIjogXCJlbi1VUyxlbjtxPTAuOVwiLFxuICAgICAgICAgICAgXCJBY2NlcHQtRW5jb2RpbmdcIjogXCJnemlwLCBkZWZsYXRlLCBiclwiLFxuICAgICAgICAgICAgXCJDb25uZWN0aW9uXCI6IFwia2VlcC1hbGl2ZVwiXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZ2V0Q29va2llU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBPYmplY3QuZW50cmllcyh0aGlzLmNvb2tpZXMpXG4gICAgICAgICAgICAuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSkgLy8gRmlsdGVyIG91dCBlbXB0eSB2YWx1ZXNcbiAgICAgICAgICAgIC5tYXAoKFtrZXksIHZhbHVlXSkgPT4gYCR7a2V5fT0ke3ZhbHVlfWApXG4gICAgICAgICAgICAuam9pbignOyAnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyBjb29raWVzIGZyb20gU3VwYWJhc2UuXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGNvb2tpZXMgd2VyZSBmb3VuZCBhbmQgbG9hZGVkLCBmYWxzZSBvdGhlcndpc2UuXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkRnJvbVN1cGFiYXNlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgICAgICAuZnJvbSgnYXV0aF9jb29raWVzJylcbiAgICAgICAgICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgICAgICAgICAub3JkZXIoJ3VwZGF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAgICAgICAgICAgICAubGltaXQoMSlcbiAgICAgICAgICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIEl0J3Mgb2theSBpZiBubyByb3dzIGV4aXN0IHlldCBvciB0YWJsZSBpcyBlbXB0eVxuICAgICAgICAgICAgICAgIGlmIChlcnJvci5jb2RlICE9PSAnUEdSU1QxMTYnKSB7IC8vIFBHUlNUMTE2IGlzIFwiSlNPTiBvYmplY3QgcmVxdWVzdGVkLCBtdWx0aXBsZSAob3Igbm8pIHJvd3MgcmV0dXJuZWRcIiBmb3Igc2luZ2xlKClcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY29va2llcyBmcm9tIFN1cGFiYXNlOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLmNvb2tpZV9qc29uKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gdHlwZW9mIGRhdGEuY29va2llX2pzb24gPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShkYXRhLmNvb2tpZV9qc29uKSA6IGRhdGEuY29va2llX2pzb247XG4gICAgICAgICAgICAgICAgdGhpcy5jb29raWVzID0geyAuLi50aGlzLmNvb2tpZXMsIC4uLnBhcnNlZCB9O1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgZXJyb3IgbG9hZGluZyBjb29raWVzOicsIGVycik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc2F2ZVRvU3VwYWJhc2UoY29va2llczogQ29va2llUmVjb3JkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU2F2aW5nIGNvb2tpZXMgdG8gU3VwYWJhc2UuLi4nKTtcbiAgICAgICAgICAgIC8vIFVwc2VydCBpbnRvIGF1dGhfY29va2llcyB3aXRoIGEgZml4ZWQgSUQgdG8gZW5zdXJlIHNpbmdsZXRvbi1saWtlIGJlaGF2aW9yXG4gICAgICAgICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgICAgIC5mcm9tKCdhdXRoX2Nvb2tpZXMnKVxuICAgICAgICAgICAgICAgIC51cHNlcnQoe1xuICAgICAgICAgICAgICAgICAgICBpZDogMSxcbiAgICAgICAgICAgICAgICAgICAgY29va2llX2pzb246IGNvb2tpZXMsXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgY29va2llcyB0byBTdXBhYmFzZTonLCBKU09OLnN0cmluZ2lmeShlcnJvciwgbnVsbCwgMikpO1xuICAgICAgICAgICAgICAgIC8vIEFkZCBoaW50IGFib3V0IFJMUy9LZXlzXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICc0MjUwMScpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignSGludDogQ2hlY2sgaWYgU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSBpcyBzZXQgaW4gTmV0bGlmeSBFbnZpcm9ubWVudCBWYXJpYWJsZXMgYW5kIGlmIFJMUyBwb2xpY2llcyBhbGxvdyB0aGUgd3JpdGUuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3VjY2Vzc2Z1bGx5IHNhdmVkIHRvIFN1cGFiYXNlLicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBbHNvIHNhdmUgdG8gbG9jYWwgZmlsZSAoc2ltdWxhdGluZyBcImxvY2FsIHN0b3JhZ2VcIiBwZXJzaXN0ZW5jZSBvbiBzZXJ2ZXIpXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEluIExhbWJkYS9OZXRsaWZ5LCBvbmx5IC90bXAgaXMgd3JpdGFibGVcbiAgICAgICAgICAgICAgICBjb25zdCBpc0xhbWJkYSA9ICEhcHJvY2Vzcy5lbnYuQVdTX0xBTUJEQV9GVU5DVElPTl9WRVJTSU9OIHx8ICEhcHJvY2Vzcy5lbnYuTkVUTElGWSB8fCAhIXByb2Nlc3MuZW52LkFXU19MQU1CREFfRlVOQ1RJT05fTkFNRTtcbiAgICAgICAgICAgICAgICBjb25zdCBkaXIgPSBpc0xhbWJkYSA/ICcvdG1wJyA6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnbGliL2Nvb2tpZScpO1xuXG4gICAgICAgICAgICAgICAgLy8gRW5zdXJlIGRpciBleGlzdHMgbG9jYWxseVxuICAgICAgICAgICAgICAgIGlmICghaXNMYW1iZGEgJiYgIWZzLmV4aXN0c1N5bmMoZGlyKSkge1xuICAgICAgICAgICAgICAgICAgICBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihkaXIsICdjb29raWVzLmpzb24nKTtcbiAgICAgICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeShjb29raWVzLCBudWxsLCAyKSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFNhdmVkIGJhY2t1cCBjb3B5IHRvICR7ZmlsZVBhdGh9YCk7XG4gICAgICAgICAgICB9IGNhdGNoIChsb2NhbEVycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGxvY2FsIHdyaXRlIGVycm9ycyBpbiBwcm9kdWN0aW9uL3NlcnZlcmxlc3MgaWYgcmVhZC1vbmx5XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb3VsZCBub3Qgc2F2ZSB0byBsb2NhbCBjb29raWVzLmpzb246JywgbG9jYWxFcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yIHNhdmluZyBjb29raWVzOicsIGVycik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGVuc3VyZVZhbGlkQ29va2llcyhmb3JjZTogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vIDEuIENoZWNrIGlmIHdlIGhhdmUgdmFsaWQgY29va2llcyBpbiBtZW1vcnlcbiAgICAgICAgY29uc3QgaGFzSW5NZW1vcnlDb29raWVzID0gdGhpcy5jb29raWVzWydjZl9jbGVhcmFuY2UnXSAmJiB0aGlzLmNvb2tpZXNbJ0FTUC5ORVRfU2Vzc2lvbklkJ107XG5cbiAgICAgICAgLy8gMi4gSWYgbm90LCBvciBpZiBpdCdzIGJlZW4gYSB3aGlsZSwgdHJ5IHRvIGxvYWQgZnJvbSBEQiBmaXJzdFxuICAgICAgICBjb25zdCB0aW1lU2luY2VMYXN0RGJDaGVjayA9IERhdGUubm93KCkgLSB0aGlzLmxhc3REYkNoZWNrO1xuXG4gICAgICAgIGlmICghaGFzSW5NZW1vcnlDb29raWVzIHx8IHRpbWVTaW5jZUxhc3REYkNoZWNrID4gdGhpcy5EQl9DSEVDS19JTlRFUlZBTCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkRnJvbVN1cGFiYXNlKCk7XG4gICAgICAgICAgICB0aGlzLmxhc3REYkNoZWNrID0gRGF0ZS5ub3coKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGhhc0Nvb2tpZXMgPSB0aGlzLmNvb2tpZXNbJ2NmX2NsZWFyYW5jZSddICYmIHRoaXMuY29va2llc1snQVNQLk5FVF9TZXNzaW9uSWQnXTtcblxuICAgICAgICBpZiAoaGFzQ29va2llcyAmJiAhZm9yY2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEF2b2lkIG11bHRpcGxlIHNpbXVsdGFuZW91cyByZWZyZXNoZXNcbiAgICAgICAgaWYgKHRoaXMuaXNSZWZyZXNoaW5nKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWZyZXNoUHJvbWlzZSkgYXdhaXQgdGhpcy5yZWZyZXNoUHJvbWlzZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaXNSZWZyZXNoaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZWZyZXNoUHJvbWlzZSA9IChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZWZyZXNoaW5nIGNvb2tpZXMgdmlhIFBsYXl3cmlnaHQuLi4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdDb29raWVzID0gYXdhaXQgcGxheXdyaWdodFNlcnZpY2UuZ2V0RnJlc2hDb29raWVzKCk7XG5cbiAgICAgICAgICAgICAgICAvLyB1c3J0a24gb2Z0ZW4gbWF0Y2hlcyBBU1AuTkVUX1Nlc3Npb25JZCB3aXRoIGEgcHJlZml4XG4gICAgICAgICAgICAgICAgaWYgKG5ld0Nvb2tpZXNbJ0FTUC5ORVRfU2Vzc2lvbklkJ10gJiYgIW5ld0Nvb2tpZXNbJ3VzcnRrbiddKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0Nvb2tpZXNbJ3VzcnRrbiddID0gYHRrbj0ke25ld0Nvb2tpZXNbJ0FTUC5ORVRfU2Vzc2lvbklkJ119YDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNvb2tpZXMgPSB7IC4uLnRoaXMuY29va2llcywgLi4ubmV3Q29va2llcyB9O1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZVRvU3VwYWJhc2UodGhpcy5jb29raWVzKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ29va2llcyByZWZyZXNoZWQgYW5kIHNhdmVkIHRvIFN1cGFiYXNlLicpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVmcmVzaCBjb29raWVzOicsIGVycm9yKTtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1JlZnJlc2hpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hQcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hQcm9taXNlO1xuICAgIH1cblxuICAgIGFzeW5jIGdldEhlYWRlcnMoKTogUHJvbWlzZTxIZWFkZXJSZWNvcmQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVWYWxpZENvb2tpZXMoZmFsc2UpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4udGhpcy5iYXNlSGVhZGVycyxcbiAgICAgICAgICAgIFwiQ29va2llXCI6IHRoaXMuZ2V0Q29va2llU3RyaW5nKClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBDYWxsZWQgYnkgQ3JvbiBKb2JcbiAgICBhc3luYyByZWZyZXNoQ29va2llcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5lbnN1cmVWYWxpZENvb2tpZXModHJ1ZSk7XG4gICAgfVxufVxuXG5jb25zdCBjb29raWVNYW5hZ2VyID0gbmV3IENvb2tpZU1hbmFnZXIoKTtcbmV4cG9ydCBkZWZhdWx0IGNvb2tpZU1hbmFnZXI7XG4iXSwibmFtZXMiOlsicGxheXdyaWdodFNlcnZpY2UiLCJzdXBhYmFzZSIsImZzIiwicGF0aCIsIkNvb2tpZU1hbmFnZXIiLCJjb25zdHJ1Y3RvciIsImlzUmVmcmVzaGluZyIsInJlZnJlc2hQcm9taXNlIiwibGFzdERiQ2hlY2siLCJEQl9DSEVDS19JTlRFUlZBTCIsImNvb2tpZXMiLCJiYXNlSGVhZGVycyIsImdldENvb2tpZVN0cmluZyIsIk9iamVjdCIsImVudHJpZXMiLCJmaWx0ZXIiLCJfIiwidmFsdWUiLCJtYXAiLCJrZXkiLCJqb2luIiwibG9hZEZyb21TdXBhYmFzZSIsImRhdGEiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJvcmRlciIsImFzY2VuZGluZyIsImxpbWl0Iiwic2luZ2xlIiwiY29kZSIsImNvbnNvbGUiLCJjb29raWVfanNvbiIsInBhcnNlZCIsIkpTT04iLCJwYXJzZSIsImVyciIsInNhdmVUb1N1cGFiYXNlIiwibG9nIiwidXBzZXJ0IiwiaWQiLCJ1cGRhdGVkX2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic3RyaW5naWZ5IiwiaXNMYW1iZGEiLCJwcm9jZXNzIiwiZW52IiwiQVdTX0xBTUJEQV9GVU5DVElPTl9WRVJTSU9OIiwiTkVUTElGWSIsIkFXU19MQU1CREFfRlVOQ1RJT05fTkFNRSIsImRpciIsImN3ZCIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJmaWxlUGF0aCIsIndyaXRlRmlsZVN5bmMiLCJsb2NhbEVycm9yIiwid2FybiIsImVuc3VyZVZhbGlkQ29va2llcyIsImZvcmNlIiwiaGFzSW5NZW1vcnlDb29raWVzIiwidGltZVNpbmNlTGFzdERiQ2hlY2siLCJub3ciLCJoYXNDb29raWVzIiwibmV3Q29va2llcyIsImdldEZyZXNoQ29va2llcyIsImdldEhlYWRlcnMiLCJyZWZyZXNoQ29va2llcyIsImNvb2tpZU1hbmFnZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/cookie/cookieManager.ts\n");

/***/ }),

/***/ "(rsc)/./lib/cookie/playwrightService.ts":
/*!*****************************************!*\
  !*** ./lib/cookie/playwrightService.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   playwrightService: () => (/* binding */ playwrightService)\n/* harmony export */ });\nclass PlaywrightService {\n    constructor(){}\n    static getInstance() {\n        if (!PlaywrightService.instance) {\n            PlaywrightService.instance = new PlaywrightService();\n        }\n        return PlaywrightService.instance;\n    }\n    async getFreshCookies() {\n        console.log(\"Starting Cloudflare bypass via Playwright...\");\n        let browser;\n        // Check if running in Netlify/Lambda environment\n        const isLambda = !!process.env.AWS_LAMBDA_FUNCTION_VERSION || !!process.env.NETLIFY || !!process.env.AWS_LAMBDA_FUNCTION_NAME;\n        if (isLambda) {\n            console.log(\"Running in Lambda/Netlify environment. Using @sparticuz/chromium\");\n            const sparticuzChromium = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! @sparticuz/chromium */ \"@sparticuz/chromium\", 23));\n            const { chromium: playwrightChromium } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! playwright-core */ \"playwright-core\", 23));\n            // @sparticuz/chromium v123+ might export 'default'\n            const chromium = sparticuzChromium.default || sparticuzChromium;\n            // Ensure we get a string path. Some versions require a location, others don't.\n            // If this still fails with \"Received undefined\", it means the library can't find its local binary.\n            // Externalizing in netlify.toml should fix the finding issue.\n            const executablePath = await chromium.executablePath();\n            browser = await playwrightChromium.launch({\n                args: chromium.args,\n                executablePath: executablePath,\n                headless: chromium.headless\n            });\n        } else {\n            console.log(\"Running in local environment. Using standard playwright.\");\n            const { chromium } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! playwright */ \"playwright\", 23));\n            browser = await chromium.launch({\n                headless: true,\n                args: [\n                    \"--no-sandbox\",\n                    \"--disable-setuid-sandbox\",\n                    \"--disable-blink-features=AutomationControlled\" // Stealth mode\n                ]\n            });\n        }\n        try {\n            const context = await browser.newContext({\n                userAgent: \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36\",\n                viewport: {\n                    width: 1280,\n                    height: 720\n                },\n                locale: \"tr-TR\",\n                timezoneId: \"Europe/Istanbul\"\n            });\n            const page = await context.newPage();\n            // Navigate to the login page\n            console.log(\"Navigating to dijidemi.com/login...\");\n            await page.goto(\"https://www.dijidemi.com/login\", {\n                waitUntil: \"domcontentloaded\",\n                timeout: 60000\n            });\n            // Wait for Username field - this confirms we passed the initial CF/DDOS screen\n            console.log(\"Waiting for login form...\");\n            try {\n                await page.waitForSelector(\"#txtUserName\", {\n                    state: \"visible\",\n                    timeout: 30000\n                });\n            } catch (e) {\n                console.log(\"Login form not found immediately, might be in CF Challenge. Waiting longer...\");\n                await page.waitForTimeout(5000);\n            }\n            // Perform Login\n            console.log(\"Attempting login...\");\n            try {\n                // Determine if we are actually on the form\n                const isFormVisible = await page.isVisible(\"#txtUserName\");\n                if (isFormVisible) {\n                    await page.fill(\"#txtUserName\", \"14308-1651\");\n                    await page.fill(\"#txtPassword\", \"175F7\");\n                    // Click login\n                    await page.click(\"#btnLogin\");\n                    console.log(\"Login clicked. Waiting for navigation...\");\n                    // Wait for successful login indicator (e.g. redirect out of /login)\n                    // Or wait for network idle\n                    await page.waitForLoadState(\"networkidle\", {\n                        timeout: 30000\n                    });\n                } else {\n                    console.error(\"Could not find login form. Possibly stuck on Cloudflare.\");\n                }\n            } catch (loginError) {\n                console.error(\"Login attempt failed or timed out:\", loginError);\n            }\n            const cookies = await context.cookies();\n            const cookieMap = {\n                \"cf_clearance\": \"\",\n                \"ASP.NET_SessionId\": \"\",\n                \"usrtkn\": \"\"\n            };\n            cookies.forEach((cookie)=>{\n                if (cookie.name in cookieMap || [\n                    \"cf_clearance\",\n                    \"ASP.NET_SessionId\",\n                    \"usrtkn\"\n                ].includes(cookie.name)) {\n                    cookieMap[cookie.name] = cookie.value;\n                }\n            });\n            const missingCookies = Object.entries(cookieMap).filter(([key, val])=>!val && [\n                    \"cf_clearance\",\n                    \"ASP.NET_SessionId\"\n                ].includes(key)) // usrtkn might not always be there initially?\n            .map(([key])=>key);\n            if (missingCookies.length > 0) {\n                console.warn(`Warning: Missing critical cookies: ${missingCookies.join(\", \")}`);\n            }\n            console.log(\"Cookies retrieved successfully.\");\n            return cookieMap;\n        } catch (error) {\n            console.error(\"Error in PlaywrightService:\", error);\n            throw error;\n        } finally{\n            if (browser) await browser.close();\n        }\n    }\n}\nconst playwrightService = PlaywrightService.getInstance();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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XSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY2hyb21pdW0gfSBmcm9tICdwbGF5d3JpZ2h0JztcblxuaW50ZXJmYWNlIENvb2tpZURhdGEge1xuICAgICdjZl9jbGVhcmFuY2UnOiBzdHJpbmc7XG4gICAgJ0FTUC5ORVRfU2Vzc2lvbklkJzogc3RyaW5nO1xuICAgICd1c3J0a24nOiBzdHJpbmc7XG4gICAgW2tleTogc3RyaW5nXTogc3RyaW5nO1xufVxuXG5jbGFzcyBQbGF5d3JpZ2h0U2VydmljZSB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFBsYXl3cmlnaHRTZXJ2aWNlO1xuXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHsgfVxuXG4gICAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBQbGF5d3JpZ2h0U2VydmljZSB7XG4gICAgICAgIGlmICghUGxheXdyaWdodFNlcnZpY2UuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIFBsYXl3cmlnaHRTZXJ2aWNlLmluc3RhbmNlID0gbmV3IFBsYXl3cmlnaHRTZXJ2aWNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBsYXl3cmlnaHRTZXJ2aWNlLmluc3RhbmNlO1xuICAgIH1cblxuICAgIGFzeW5jIGdldEZyZXNoQ29va2llcygpOiBQcm9taXNlPENvb2tpZURhdGE+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1N0YXJ0aW5nIENsb3VkZmxhcmUgYnlwYXNzIHZpYSBQbGF5d3JpZ2h0Li4uJyk7XG5cbiAgICAgICAgbGV0IGJyb3dzZXI7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgcnVubmluZyBpbiBOZXRsaWZ5L0xhbWJkYSBlbnZpcm9ubWVudFxuICAgICAgICBjb25zdCBpc0xhbWJkYSA9ICEhcHJvY2Vzcy5lbnYuQVdTX0xBTUJEQV9GVU5DVElPTl9WRVJTSU9OIHx8ICEhcHJvY2Vzcy5lbnYuTkVUTElGWSB8fCAhIXByb2Nlc3MuZW52LkFXU19MQU1CREFfRlVOQ1RJT05fTkFNRTtcblxuICAgICAgICBpZiAoaXNMYW1iZGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSdW5uaW5nIGluIExhbWJkYS9OZXRsaWZ5IGVudmlyb25tZW50LiBVc2luZyBAc3BhcnRpY3V6L2Nocm9taXVtJyk7XG4gICAgICAgICAgICBjb25zdCBzcGFydGljdXpDaHJvbWl1bSA9IGF3YWl0IGltcG9ydCgnQHNwYXJ0aWN1ei9jaHJvbWl1bScpO1xuICAgICAgICAgICAgY29uc3QgeyBjaHJvbWl1bTogcGxheXdyaWdodENocm9taXVtIH0gPSBhd2FpdCBpbXBvcnQoJ3BsYXl3cmlnaHQtY29yZScpO1xuXG4gICAgICAgICAgICAvLyBAc3BhcnRpY3V6L2Nocm9taXVtIHYxMjMrIG1pZ2h0IGV4cG9ydCAnZGVmYXVsdCdcbiAgICAgICAgICAgIGNvbnN0IGNocm9taXVtID0gKHNwYXJ0aWN1ekNocm9taXVtLmRlZmF1bHQgfHwgc3BhcnRpY3V6Q2hyb21pdW0pIGFzIGFueTtcblxuICAgICAgICAgICAgLy8gRW5zdXJlIHdlIGdldCBhIHN0cmluZyBwYXRoLiBTb21lIHZlcnNpb25zIHJlcXVpcmUgYSBsb2NhdGlvbiwgb3RoZXJzIGRvbid0LlxuICAgICAgICAgICAgLy8gSWYgdGhpcyBzdGlsbCBmYWlscyB3aXRoIFwiUmVjZWl2ZWQgdW5kZWZpbmVkXCIsIGl0IG1lYW5zIHRoZSBsaWJyYXJ5IGNhbid0IGZpbmQgaXRzIGxvY2FsIGJpbmFyeS5cbiAgICAgICAgICAgIC8vIEV4dGVybmFsaXppbmcgaW4gbmV0bGlmeS50b21sIHNob3VsZCBmaXggdGhlIGZpbmRpbmcgaXNzdWUuXG4gICAgICAgICAgICBjb25zdCBleGVjdXRhYmxlUGF0aCA9IGF3YWl0IGNocm9taXVtLmV4ZWN1dGFibGVQYXRoKCk7XG5cbiAgICAgICAgICAgIGJyb3dzZXIgPSBhd2FpdCBwbGF5d3JpZ2h0Q2hyb21pdW0ubGF1bmNoKHtcbiAgICAgICAgICAgICAgICBhcmdzOiBjaHJvbWl1bS5hcmdzLFxuICAgICAgICAgICAgICAgIGV4ZWN1dGFibGVQYXRoOiBleGVjdXRhYmxlUGF0aCxcbiAgICAgICAgICAgICAgICBoZWFkbGVzczogY2hyb21pdW0uaGVhZGxlc3MsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1J1bm5pbmcgaW4gbG9jYWwgZW52aXJvbm1lbnQuIFVzaW5nIHN0YW5kYXJkIHBsYXl3cmlnaHQuJyk7XG4gICAgICAgICAgICBjb25zdCB7IGNocm9taXVtIH0gPSBhd2FpdCBpbXBvcnQoJ3BsYXl3cmlnaHQnKTtcbiAgICAgICAgICAgIGJyb3dzZXIgPSBhd2FpdCBjaHJvbWl1bS5sYXVuY2goe1xuICAgICAgICAgICAgICAgIGhlYWRsZXNzOiB0cnVlLFxuICAgICAgICAgICAgICAgIGFyZ3M6IFtcbiAgICAgICAgICAgICAgICAgICAgJy0tbm8tc2FuZGJveCcsXG4gICAgICAgICAgICAgICAgICAgICctLWRpc2FibGUtc2V0dWlkLXNhbmRib3gnLFxuICAgICAgICAgICAgICAgICAgICAnLS1kaXNhYmxlLWJsaW5rLWZlYXR1cmVzPUF1dG9tYXRpb25Db250cm9sbGVkJyAvLyBTdGVhbHRoIG1vZGVcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgYnJvd3Nlci5uZXdDb250ZXh0KHtcbiAgICAgICAgICAgICAgICB1c2VyQWdlbnQ6ICdNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMF8xNV83KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTI1LjAuMC4wIFNhZmFyaS81MzcuMzYnLFxuICAgICAgICAgICAgICAgIHZpZXdwb3J0OiB7IHdpZHRoOiAxMjgwLCBoZWlnaHQ6IDcyMCB9LFxuICAgICAgICAgICAgICAgIGxvY2FsZTogJ3RyLVRSJyxcbiAgICAgICAgICAgICAgICB0aW1lem9uZUlkOiAnRXVyb3BlL0lzdGFuYnVsJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBwYWdlID0gYXdhaXQgY29udGV4dC5uZXdQYWdlKCk7XG5cbiAgICAgICAgICAgIC8vIE5hdmlnYXRlIHRvIHRoZSBsb2dpbiBwYWdlXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTmF2aWdhdGluZyB0byBkaWppZGVtaS5jb20vbG9naW4uLi4nKTtcbiAgICAgICAgICAgIGF3YWl0IHBhZ2UuZ290bygnaHR0cHM6Ly93d3cuZGlqaWRlbWkuY29tL2xvZ2luJywge1xuICAgICAgICAgICAgICAgIHdhaXRVbnRpbDogJ2RvbWNvbnRlbnRsb2FkZWQnLFxuICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gV2FpdCBmb3IgVXNlcm5hbWUgZmllbGQgLSB0aGlzIGNvbmZpcm1zIHdlIHBhc3NlZCB0aGUgaW5pdGlhbCBDRi9ERE9TIHNjcmVlblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1dhaXRpbmcgZm9yIGxvZ2luIGZvcm0uLi4nKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yU2VsZWN0b3IoJyN0eHRVc2VyTmFtZScsIHsgc3RhdGU6ICd2aXNpYmxlJywgdGltZW91dDogMzAwMDAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvZ2luIGZvcm0gbm90IGZvdW5kIGltbWVkaWF0ZWx5LCBtaWdodCBiZSBpbiBDRiBDaGFsbGVuZ2UuIFdhaXRpbmcgbG9uZ2VyLi4uJyk7XG4gICAgICAgICAgICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yVGltZW91dCg1MDAwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUGVyZm9ybSBMb2dpblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0F0dGVtcHRpbmcgbG9naW4uLi4nKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIHdlIGFyZSBhY3R1YWxseSBvbiB0aGUgZm9ybVxuICAgICAgICAgICAgICAgIGNvbnN0IGlzRm9ybVZpc2libGUgPSBhd2FpdCBwYWdlLmlzVmlzaWJsZSgnI3R4dFVzZXJOYW1lJyk7XG4gICAgICAgICAgICAgICAgaWYgKGlzRm9ybVZpc2libGUpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcGFnZS5maWxsKCcjdHh0VXNlck5hbWUnLCAnMTQzMDgtMTY1MScpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwYWdlLmZpbGwoJyN0eHRQYXNzd29yZCcsICcxNzVGNycpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENsaWNrIGxvZ2luXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJyNidG5Mb2dpbicpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2dpbiBjbGlja2VkLiBXYWl0aW5nIGZvciBuYXZpZ2F0aW9uLi4uJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gV2FpdCBmb3Igc3VjY2Vzc2Z1bCBsb2dpbiBpbmRpY2F0b3IgKGUuZy4gcmVkaXJlY3Qgb3V0IG9mIC9sb2dpbilcbiAgICAgICAgICAgICAgICAgICAgLy8gT3Igd2FpdCBmb3IgbmV0d29yayBpZGxlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBhZ2Uud2FpdEZvckxvYWRTdGF0ZSgnbmV0d29ya2lkbGUnLCB7IHRpbWVvdXQ6IDMwMDAwIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvdWxkIG5vdCBmaW5kIGxvZ2luIGZvcm0uIFBvc3NpYmx5IHN0dWNrIG9uIENsb3VkZmxhcmUuJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGNhdGNoIChsb2dpbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTG9naW4gYXR0ZW1wdCBmYWlsZWQgb3IgdGltZWQgb3V0OicsIGxvZ2luRXJyb3IpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjb29raWVzID0gYXdhaXQgY29udGV4dC5jb29raWVzKCk7XG4gICAgICAgICAgICBjb25zdCBjb29raWVNYXA6IENvb2tpZURhdGEgPSB7XG4gICAgICAgICAgICAgICAgJ2NmX2NsZWFyYW5jZSc6ICcnLFxuICAgICAgICAgICAgICAgICdBU1AuTkVUX1Nlc3Npb25JZCc6ICcnLFxuICAgICAgICAgICAgICAgICd1c3J0a24nOiAnJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgY29va2llcy5mb3JFYWNoKGNvb2tpZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNvb2tpZS5uYW1lIGluIGNvb2tpZU1hcCB8fCBbJ2NmX2NsZWFyYW5jZScsICdBU1AuTkVUX1Nlc3Npb25JZCcsICd1c3J0a24nXS5pbmNsdWRlcyhjb29raWUubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29va2llTWFwW2Nvb2tpZS5uYW1lXSA9IGNvb2tpZS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgbWlzc2luZ0Nvb2tpZXMgPSBPYmplY3QuZW50cmllcyhjb29raWVNYXApXG4gICAgICAgICAgICAgICAgLmZpbHRlcigoW2tleSwgdmFsXSkgPT4gIXZhbCAmJiBbJ2NmX2NsZWFyYW5jZScsICdBU1AuTkVUX1Nlc3Npb25JZCddLmluY2x1ZGVzKGtleSkpIC8vIHVzcnRrbiBtaWdodCBub3QgYWx3YXlzIGJlIHRoZXJlIGluaXRpYWxseT9cbiAgICAgICAgICAgICAgICAubWFwKChba2V5XSkgPT4ga2V5KTtcblxuICAgICAgICAgICAgaWYgKG1pc3NpbmdDb29raWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFdhcm5pbmc6IE1pc3NpbmcgY3JpdGljYWwgY29va2llczogJHttaXNzaW5nQ29va2llcy5qb2luKCcsICcpfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ29va2llcyByZXRyaWV2ZWQgc3VjY2Vzc2Z1bGx5LicpO1xuICAgICAgICAgICAgcmV0dXJuIGNvb2tpZU1hcDtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gUGxheXdyaWdodFNlcnZpY2U6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoYnJvd3NlcikgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgcGxheXdyaWdodFNlcnZpY2UgPSBQbGF5d3JpZ2h0U2VydmljZS5nZXRJbnN0YW5jZSgpO1xuIl0sIm5hbWVzIjpbIlBsYXl3cmlnaHRTZXJ2aWNlIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsImdldEZyZXNoQ29va2llcyIsImNvbnNvbGUiLCJsb2ciLCJicm93c2VyIiwiaXNMYW1iZGEiLCJwcm9jZXNzIiwiZW52IiwiQVdTX0xBTUJEQV9GVU5DVElPTl9WRVJTSU9OIiwiTkVUTElGWSIsIkFXU19MQU1CREFfRlVOQ1RJT05fTkFNRSIsInNwYXJ0aWN1ekNocm9taXVtIiwiY2hyb21pdW0iLCJwbGF5d3JpZ2h0Q2hyb21pdW0iLCJkZWZhdWx0IiwiZXhlY3V0YWJsZVBhdGgiLCJsYXVuY2giLCJhcmdzIiwiaGVhZGxlc3MiLCJjb250ZXh0IiwibmV3Q29udGV4dCIsInVzZXJBZ2VudCIsInZpZXdwb3J0Iiwid2lkdGgiLCJoZWlnaHQiLCJsb2NhbGUiLCJ0aW1lem9uZUlkIiwicGFnZSIsIm5ld1BhZ2UiLCJnb3RvIiwid2FpdFVudGlsIiwidGltZW91dCIsIndhaXRGb3JTZWxlY3RvciIsInN0YXRlIiwiZSIsIndhaXRGb3JUaW1lb3V0IiwiaXNGb3JtVmlzaWJsZSIsImlzVmlzaWJsZSIsImZpbGwiLCJjbGljayIsIndhaXRGb3JMb2FkU3RhdGUiLCJlcnJvciIsImxvZ2luRXJyb3IiLCJjb29raWVzIiwiY29va2llTWFwIiwiZm9yRWFjaCIsImNvb2tpZSIsIm5hbWUiLCJpbmNsdWRlcyIsInZhbHVlIiwibWlzc2luZ0Nvb2tpZXMiLCJPYmplY3QiLCJlbnRyaWVzIiwiZmlsdGVyIiwia2V5IiwidmFsIiwibWFwIiwibGVuZ3RoIiwid2FybiIsImpvaW4iLCJjbG9zZSIsInBsYXl3cmlnaHRTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/cookie/playwrightService.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/supabase.ts":
/*!****************************!*\
  !*** ./lib/db/supabase.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/esm/wrapper.mjs\");\n\nconst supabaseUrl = \"https://mofugpfhwbgcunkfkrhc.supabase.co\";\n// Prioritize Service Role Key for backend operations (bypasses RLS)\nconst supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY || \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1vZnVncGZod2JnY3Vua2ZrcmhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4MTIxNTUsImV4cCI6MjA4MTM4ODE1NX0.M910703VczSYfcaucltLCNZKCb1-iHoyZr-5VmpkG1o\";\n// Ensure we have the keys before creating the client to avoid runtime errors\nif (!supabaseUrl || !supabaseKey) {\n    console.warn(\"Supabase credentials are missing. Cookie persistence will not work.\");\n}\n// Use placeholders to prevent build crash if env vars are missing\nconst url = supabaseUrl || \"https://placeholder.supabase.co\";\nconst key = supabaseKey || \"placeholder\";\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(url, key, {\n    auth: {\n        persistSession: false,\n        autoRefreshToken: false\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvc3VwYWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUQ7QUFFckQsTUFBTUMsY0FBY0MsMENBQW9DO0FBQ3hELG9FQUFvRTtBQUNwRSxNQUFNRyxjQUFjSCxRQUFRQyxHQUFHLENBQUNHLHlCQUF5QixJQUFJSixrTkFBeUM7QUFFdEcsNkVBQTZFO0FBQzdFLElBQUksQ0FBQ0QsZUFBZSxDQUFDSSxhQUFhO0lBQzlCRyxRQUFRQyxJQUFJLENBQUM7QUFDakI7QUFFQSxrRUFBa0U7QUFDbEUsTUFBTUMsTUFBTVQsZUFBZTtBQUMzQixNQUFNVSxNQUFNTixlQUFlO0FBRXBCLE1BQU1PLFdBQVdaLG1FQUFZQSxDQUFDVSxLQUFLQyxLQUFLO0lBQzNDRSxNQUFNO1FBQ0ZDLGdCQUFnQjtRQUNoQkMsa0JBQWtCO0lBQ3RCO0FBQ0osR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtYXBwLy4vbGliL2RiL3N1cGFiYXNlLnRzPzE4YjIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhO1xuLy8gUHJpb3JpdGl6ZSBTZXJ2aWNlIFJvbGUgS2V5IGZvciBiYWNrZW5kIG9wZXJhdGlvbnMgKGJ5cGFzc2VzIFJMUylcbmNvbnN0IHN1cGFiYXNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSB8fCBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSE7XG5cbi8vIEVuc3VyZSB3ZSBoYXZlIHRoZSBrZXlzIGJlZm9yZSBjcmVhdGluZyB0aGUgY2xpZW50IHRvIGF2b2lkIHJ1bnRpbWUgZXJyb3JzXG5pZiAoIXN1cGFiYXNlVXJsIHx8ICFzdXBhYmFzZUtleSkge1xuICAgIGNvbnNvbGUud2FybignU3VwYWJhc2UgY3JlZGVudGlhbHMgYXJlIG1pc3NpbmcuIENvb2tpZSBwZXJzaXN0ZW5jZSB3aWxsIG5vdCB3b3JrLicpO1xufVxuXG4vLyBVc2UgcGxhY2Vob2xkZXJzIHRvIHByZXZlbnQgYnVpbGQgY3Jhc2ggaWYgZW52IHZhcnMgYXJlIG1pc3NpbmdcbmNvbnN0IHVybCA9IHN1cGFiYXNlVXJsIHx8ICdodHRwczovL3BsYWNlaG9sZGVyLnN1cGFiYXNlLmNvJztcbmNvbnN0IGtleSA9IHN1cGFiYXNlS2V5IHx8ICdwbGFjZWhvbGRlcic7XG5cbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudCh1cmwsIGtleSwge1xuICAgIGF1dGg6IHtcbiAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlLCAvLyBTZXJ2aWNlIFJvbGUgZG9lc24ndCBuZWVkIHNlc3Npb24gcGVyc2lzdGVuY2VcbiAgICAgICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXG4gICAgfVxufSk7XG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VLZXkiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJjb25zb2xlIiwid2FybiIsInVybCIsImtleSIsInN1cGFiYXNlIiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIiwiYXV0b1JlZnJlc2hUb2tlbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/supabase.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/@supabase","vendor-chunks/iceberg-js"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fvideo%2Froute&page=%2Fapi%2Fvideo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fvideo%2Froute.ts&appDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmustafa%2FDocuments%2FGitHub%2Fdijidemi-fetch&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();